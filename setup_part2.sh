#!/bin/bash

set -e

echo "ðŸš€ æ®‹ã‚Šã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’é–‹å§‹ã—ã¾ã™..."

# -----------------------------------------------------------------------------
# .claude/commands/implement.md
# -----------------------------------------------------------------------------
mkdir -p .claude/commands
mkdir -p .claude/agents

cat > .claude/commands/implement.md << 'EOF'
---
name: implement
description: æ©Ÿèƒ½å®Ÿè£…ã‚’ä¾é ¼ã™ã‚‹ã€‚Issueç•ªå·ã¾ãŸã¯æ©Ÿèƒ½èª¬æ˜Žã‚’å¼•æ•°ã¨ã—ã¦æ¸¡ã™ã€‚
---

# å®Ÿè£…ã‚¿ã‚¹ã‚¯

$ARGUMENTS

## å®Ÿè£…æ‰‹é †

1. **è¦ä»¶ç¢ºèª**
   - docs/REQUIREMENTS.md ã§è©²å½“æ©Ÿèƒ½ã®è¦ä»¶ã‚’ç¢ºèª
   - ä¸æ˜Žç‚¹ãŒã‚ã‚Œã°è³ªå•

2. **è¨­è¨ˆç¢ºèª**
   - docs/ARCHITECTURE.md ã§è¨­è¨ˆæ–¹é‡ã‚’ç¢ºèª
   - æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¨ã®æ•´åˆæ€§ã‚’ç¢ºèª

3. **ãƒ†ã‚¹ãƒˆå…ˆè¡Œï¼ˆTDDï¼‰**
   - tests/ ã«è©²å½“ã™ã‚‹ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã¾ãŸã¯æ›´æ–°
   - æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ãƒ»å¢ƒç•Œå€¤ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’ä½œæˆ
   - ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆRedï¼‰

4. **å®Ÿè£…**
   - src/ ã«å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ
   - CLAUDE.md ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«å¾“ã†
   - åž‹ãƒ’ãƒ³ãƒˆã€docstringã‚’å¿…ãšè¨˜è¿°

5. **ãƒ†ã‚¹ãƒˆé€šéŽç¢ºèªï¼ˆGreenï¼‰**
   - `uv run pytest tests/ -v` ã§å…¨ãƒ†ã‚¹ãƒˆé€šéŽã‚’ç¢ºèª

6. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**
   - ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ã‚’æŽ’é™¤
   - å¯èª­æ€§ã‚’å‘ä¸Š

7. **ãƒªãƒ³ãƒˆãƒ»åž‹ãƒã‚§ãƒƒã‚¯**
   - `uv run ruff check src/`
   - `uv run pyright src/`

8. **å®Œäº†å ±å‘Š**
   - å®Ÿè£…å†…å®¹ã®ã‚µãƒžãƒªãƒ¼ã‚’å ±å‘Š
   - å¤‰æ›´ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’æç¤º
EOF

# -----------------------------------------------------------------------------
# .claude/commands/review.md
# -----------------------------------------------------------------------------
cat > .claude/commands/review.md << 'EOF'
---
name: review
description: ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä¾é ¼ã™ã‚‹ã€‚ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä¸¦åˆ—ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
---

# ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼

$ARGUMENTS

## ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿè¡Œ

ä»¥ä¸‹ã®å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ä¸¦åˆ—ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä¾é ¼ã—ã¾ã™ã€‚

1. **python-expert** ã«ä¾é ¼ï¼šPythonã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹è¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼
2. **security-reviewer** ã«ä¾é ¼ï¼šã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼
3. **code-reviewer** ã«ä¾é ¼ï¼šå¯èª­æ€§ãƒ»ä¿å®ˆæ€§è¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼
4. **qa-reviewer** ã«ä¾é ¼ï¼šãƒ†ã‚¹ãƒˆå“è³ªè¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼
5. **discord-expert** ã«ä¾é ¼ï¼šDiscord APIè¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰

## ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæžœã®çµ±åˆ

å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæžœã‚’ä»¥ä¸‹ã®å½¢å¼ã§çµ±åˆã—ã¦ãã ã•ã„ã€‚

### ðŸ”´ Criticalï¼ˆå¿…é ˆä¿®æ­£ï¼‰
- ä¿®æ­£ã—ãªã„ã¨ãƒã‚°ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡ŒãŒç™ºç”Ÿã™ã‚‹ã‚‚ã®

### ðŸŸ¡ Warningï¼ˆæŽ¨å¥¨ä¿®æ­£ï¼‰
- ä¿®æ­£ã—ãŸæ–¹ãŒè‰¯ã„ãŒã€å‹•ä½œã«ã¯å½±éŸ¿ã—ãªã„ã‚‚ã®

### ðŸŸ¢ Suggestionï¼ˆææ¡ˆï¼‰
- ã‚ˆã‚Šè‰¯ãã™ã‚‹ãŸã‚ã®ææ¡ˆ

### âœ… Good Pointsï¼ˆè‰¯ã„ç‚¹ï¼‰
- è‰¯ã„å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„å·¥å¤«
EOF

# -----------------------------------------------------------------------------
# .claude/commands/test.md
# -----------------------------------------------------------------------------
cat > .claude/commands/test.md << 'EOF'
---
name: test
description: ãƒ†ã‚¹ãƒˆä½œæˆã‚’ä¾é ¼ã™ã‚‹ã€‚å¯¾è±¡ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¼•æ•°ã¨ã—ã¦æ¸¡ã™ã€‚
---

# ãƒ†ã‚¹ãƒˆä½œæˆ

$ARGUMENTS

## ãƒ†ã‚¹ãƒˆä½œæˆæ‰‹é †

1. **å¯¾è±¡ã‚³ãƒ¼ãƒ‰ã®ç†è§£**
   - å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ©Ÿèƒ½ã‚’æŠŠæ¡
   - å…¥å‡ºåŠ›ã€å‰¯ä½œç”¨ã‚’ç¢ºèª

2. **ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¨­è¨ˆ**
   docs/TEST_PLAN.md ã‚’å‚ç…§ã—ã€ä»¥ä¸‹ã®è¦³ç‚¹ã§ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¨­è¨ˆï¼š
   - æ­£å¸¸ç³»ï¼šæœŸå¾…é€šã‚Šã®å…¥åŠ›ã§æœŸå¾…é€šã‚Šã®å‡ºåŠ›
   - ç•°å¸¸ç³»ï¼šä¸æ­£ãªå…¥åŠ›ã§ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
   - å¢ƒç•Œå€¤ï¼šé™ç•Œå€¤ä»˜è¿‘ã®å‹•ä½œ

3. **ãƒ†ã‚¹ãƒˆå®Ÿè£…**
   - tests/ ã«ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
   - pytestå½¢å¼ã§è¨˜è¿°
   - fixtureã‚’é©åˆ‡ã«ä½¿ç”¨

4. **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**
   - `uv run pytest tests/ -v` ã§å®Ÿè¡Œ

5. **ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèª**
   - `uv run pytest tests/ --cov=src --cov-report=html`
   - 70%ä»¥ä¸Šã‚’ç›®æ¨™
EOF

# -----------------------------------------------------------------------------
# .claude/commands/fix-issue.md
# -----------------------------------------------------------------------------
cat > .claude/commands/fix-issue.md << 'EOF'
---
name: fix-issue
description: GitHub Issueã®ä¿®æ­£ã‚’ä¾é ¼ã™ã‚‹ã€‚Issueç•ªå·ã‚’å¼•æ•°ã¨ã—ã¦æ¸¡ã™ã€‚
---

# Issueä¿®æ­£

Issue: $ARGUMENTS

## ä¿®æ­£æ‰‹é †

1. **Issueå†…å®¹ã®å–å¾—**
   - `gh issue view $ARGUMENTS` ã§Issueè©³ç´°ã‚’å–å¾—
   - å•é¡Œã®å†…å®¹ã¨æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã‚’ç¢ºèª

2. **åŽŸå› åˆ†æž**
   - é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
   - å•é¡Œã®æ ¹æœ¬åŽŸå› ã‚’ç‰¹å®š

3. **ãƒ†ã‚¹ãƒˆä½œæˆï¼ˆå†ç¾ç¢ºèªï¼‰**
   - å•é¡Œã‚’å†ç¾ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’ä½œæˆ
   - ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèª

4. **ä¿®æ­£å®Ÿè£…**
   - æœ€å°é™ã®å¤‰æ›´ã§ä¿®æ­£
   - å‰¯ä½œç”¨ãŒãªã„ã“ã¨ã‚’ç¢ºèª

5. **ãƒ†ã‚¹ãƒˆé€šéŽç¢ºèª**
   - ä½œæˆã—ãŸãƒ†ã‚¹ãƒˆãŒé€šéŽ
   - æ—¢å­˜ãƒ†ã‚¹ãƒˆã‚‚å…¨ã¦é€šéŽ

6. **ã‚³ãƒŸãƒƒãƒˆãƒ»PRä½œæˆ**
   - `git commit -m "fix: #{Issueç•ªå·} {ä¿®æ­£å†…å®¹}"`
   - `gh pr create --title "fix: #{Issueç•ªå·} {ä¿®æ­£å†…å®¹}"`
EOF

# -----------------------------------------------------------------------------
# .claude/commands/refactor.md
# -----------------------------------------------------------------------------
cat > .claude/commands/refactor.md << 'EOF'
---
name: refactor
description: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’ä¾é ¼ã™ã‚‹ã€‚å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å¼•æ•°ã¨ã—ã¦æ¸¡ã™ã€‚
---

# ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

$ARGUMENTS

## ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ‰‹é †

1. **ç¾çŠ¶åˆ†æž**
   - å¯¾è±¡ã‚³ãƒ¼ãƒ‰ã®å•é¡Œç‚¹ã‚’ç‰¹å®š
   - æ”¹å–„ã®æ–¹å‘æ€§ã‚’æ±ºå®š

2. **ãƒ†ã‚¹ãƒˆç¢ºèª**
   - æ—¢å­˜ãƒ†ã‚¹ãƒˆãŒååˆ†ã«ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
   - ä¸è¶³ã—ã¦ã„ã‚Œã°ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 

3. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Ÿè¡Œ**
   ä»¥ä¸‹ã®è¦³ç‚¹ã§æ”¹å–„ï¼š
   - é‡è¤‡ã‚³ãƒ¼ãƒ‰ã®æŽ’é™¤ï¼ˆDRYåŽŸå‰‡ï¼‰
   - é–¢æ•°ãƒ»ã‚¯ãƒ©ã‚¹ã®è²¬ä»»åˆ†é›¢ï¼ˆå˜ä¸€è²¬ä»»åŽŸå‰‡ï¼‰
   - å‘½åã®æ”¹å–„
   - è¤‡é›‘åº¦ã®ä½Žæ¸›
   - åž‹ãƒ’ãƒ³ãƒˆã®è¿½åŠ ãƒ»ä¿®æ­£

4. **ãƒ†ã‚¹ãƒˆé€šéŽç¢ºèª**
   - `uv run pytest tests/ -v`
   - å‹•ä½œãŒå¤‰ã‚ã£ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª

5. **ãƒªãƒ³ãƒˆãƒ»åž‹ãƒã‚§ãƒƒã‚¯**
   - `uv run ruff check src/`
   - `uv run pyright src/`
EOF

echo "âœ… .claude/commands/ ã‚’ä½œæˆã—ã¾ã—ãŸ"

# -----------------------------------------------------------------------------
# .claude/agents/python-expert.md
# -----------------------------------------------------------------------------
cat > .claude/agents/python-expert.md << 'EOF'
---
name: python-expert
description: Pythonã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã€ã‚³ãƒ¼ãƒ‰å“è³ªã‚’åˆ†æžã™ã‚‹å ´åˆã«ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã€‚
tools: Glob, Grep, Read
model: inherit
---

ã‚ãªãŸã¯Pythonã®å°‚é–€å®¶ã§ã™ã€‚ä»¥ä¸‹ã®è¦³ç‚¹ã§ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚

## åˆ†æžè¦³ç‚¹

### Pythonãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- PEP 8æº–æ‹ 
- Pythonic ãªã‚³ãƒ¼ãƒ‰
- é©åˆ‡ãªä¾‹å¤–å‡¦ç†
- ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒžãƒãƒ¼ã‚¸ãƒ£ã®ä½¿ç”¨

### åž‹ãƒ’ãƒ³ãƒˆ
- å…¨ã¦ã®é–¢æ•°ã«åž‹ãƒ’ãƒ³ãƒˆãŒã‚ã‚‹ã‹
- Optional, Union ã®é©åˆ‡ãªä½¿ç”¨

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹
- ä¸è¦ãªãƒ«ãƒ¼ãƒ—ã€è¨ˆç®—ã®é‡è¤‡
- ãƒ¡ãƒ¢ãƒªåŠ¹çŽ‡
- éžåŒæœŸå‡¦ç†ã®é©åˆ‡ãªä½¿ç”¨

## å‡ºåŠ›å½¢å¼

- **å ´æ‰€**: ãƒ•ã‚¡ã‚¤ãƒ«å:è¡Œç•ªå·
- **å•é¡Œ**: ä½•ãŒå•é¡Œã‹
- **ææ¡ˆ**: ã©ã†æ”¹å–„ã™ã¹ãã‹
- **é‡è¦åº¦**: Critical / Warning / Suggestion
EOF

# -----------------------------------------------------------------------------
# .claude/agents/security-reviewer.md
# -----------------------------------------------------------------------------
cat > .claude/agents/security-reviewer.md << 'EOF'
---
name: security-reviewer
description: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€æ¨©é™åˆ†é›¢ã€ãƒ‡ãƒ¼ã‚¿ä¿è­·ã‚’åˆ†æžã™ã‚‹å ´åˆã«ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã€‚
tools: Glob, Grep, Read
model: inherit
---

ã‚ãªãŸã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å°‚é–€å®¶ã§ã™ã€‚ä»¥ä¸‹ã®è¦³ç‚¹ã§ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚

## åˆ†æžè¦³ç‚¹

### èªè¨¼ãƒ»èªå¯
- APIã‚­ãƒ¼ã€ãƒˆãƒ¼ã‚¯ãƒ³ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒãªã„ã‹
- ç’°å¢ƒå¤‰æ•°ã‹ã‚‰ã®é©åˆ‡ãªèª­ã¿è¾¼ã¿
- æ¨©é™ãƒã‚§ãƒƒã‚¯ã®å®Ÿè£…

### ãƒ‡ãƒ¼ã‚¿ä¿è­·
- Workspaceé–“ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢ãŒå¾¹åº•ã•ã‚Œã¦ã„ã‚‹ã‹
- SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®å¯èƒ½æ€§
- æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®ãƒ­ã‚°å‡ºåŠ›ãŒãªã„ã‹

### Discord APIå›ºæœ‰
- Bot Tokenã®å®‰å…¨ãªç®¡ç†
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®è€ƒæ…®
- é–‹ç™ºè€…ãƒãƒªã‚·ãƒ¼ã¸ã®æº–æ‹ 

## å‡ºåŠ›å½¢å¼

- **å ´æ‰€**: ãƒ•ã‚¡ã‚¤ãƒ«å:è¡Œç•ªå·
- **è„†å¼±æ€§**: ä½•ãŒå•é¡Œã‹
- **å½±éŸ¿**: ã©ã®ã‚ˆã†ãªæ”»æ’ƒãŒå¯èƒ½ã‹
- **å¯¾ç­–**: ã©ã†ä¿®æ­£ã™ã¹ãã‹
- **é‡è¦åº¦**: Critical / Warning / Suggestion
EOF

# -----------------------------------------------------------------------------
# .claude/agents/code-reviewer.md
# -----------------------------------------------------------------------------
cat > .claude/agents/code-reviewer.md << 'EOF'
---
name: code-reviewer
description: å¯èª­æ€§ã€ä¿å®ˆæ€§ã€ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã‚’åˆ†æžã™ã‚‹å ´åˆã«ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã€‚
tools: Glob, Grep, Read
model: inherit
---

ã‚ãªãŸã¯ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®å°‚é–€å®¶ã§ã™ã€‚ä»¥ä¸‹ã®è¦³ç‚¹ã§ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚

## åˆ†æžè¦³ç‚¹

### å¯èª­æ€§
- å¤‰æ•°åã€é–¢æ•°åã€ã‚¯ãƒ©ã‚¹åã¯æ„å›³ã‚’è¡¨ã—ã¦ã„ã‚‹ã‹
- é–¢æ•°ã®é•·ã•ã¯é©åˆ‡ã‹ï¼ˆ50è¡Œä»¥å†…æŽ¨å¥¨ï¼‰
- ãƒã‚¹ãƒˆãŒæ·±ã™ãŽãªã„ã‹ï¼ˆ3æ®µéšŽä»¥å†…æŽ¨å¥¨ï¼‰
- ã‚³ãƒ¡ãƒ³ãƒˆãƒ»docstringã¯é©åˆ‡ã‹

### ä¿å®ˆæ€§
- å˜ä¸€è²¬ä»»åŽŸå‰‡ã«å¾“ã£ã¦ã„ã‚‹ã‹
- DRYåŽŸå‰‡ï¼ˆé‡è¤‡ã‚³ãƒ¼ãƒ‰ãŒãªã„ã‹ï¼‰
- æŠ½è±¡åŒ–ã®ãƒ¬ãƒ™ãƒ«ã¯é©åˆ‡ã‹

### ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„
- CLAUDE.md ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«å¾“ã£ã¦ã„ã‚‹ã‹
- ä¸€è²«ã—ãŸã‚¹ã‚¿ã‚¤ãƒ«
- ãƒžã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã®æŽ’é™¤

## å‡ºåŠ›å½¢å¼

- **å ´æ‰€**: ãƒ•ã‚¡ã‚¤ãƒ«å:è¡Œç•ªå·
- **å•é¡Œ**: ä½•ãŒå•é¡Œã‹
- **ææ¡ˆ**: ã©ã†æ”¹å–„ã™ã¹ãã‹
- **é‡è¦åº¦**: Critical / Warning / Suggestion
EOF

# -----------------------------------------------------------------------------
# .claude/agents/qa-reviewer.md
# -----------------------------------------------------------------------------
cat > .claude/agents/qa-reviewer.md << 'EOF'
---
name: qa-reviewer
description: ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã€ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã€å“è³ªã‚’åˆ†æžã™ã‚‹å ´åˆã«ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã€‚
tools: Glob, Grep, Read
model: inherit
---

ã‚ãªãŸã¯QAï¼ˆå“è³ªä¿è¨¼ï¼‰ã®å°‚é–€å®¶ã§ã™ã€‚ä»¥ä¸‹ã®è¦³ç‚¹ã§ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚

## åˆ†æžè¦³ç‚¹

### ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸
- å®Ÿè£…ã«å¯¾å¿œã™ã‚‹ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ã‹
- æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ãƒ»å¢ƒç•Œå€¤ãŒã‚«ãƒãƒ¼ã•ã‚Œã¦ã„ã‚‹ã‹

### ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
- null/None ã®å‡¦ç†
- ç©ºã®ãƒªã‚¹ãƒˆã€ç©ºæ–‡å­—åˆ—ã®å‡¦ç†
- å¢ƒç•Œå€¤ï¼ˆ0ã€æœ€å¤§å€¤ã€æœ€å°å€¤ï¼‰

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ä¾‹å¤–ãŒé©åˆ‡ã«ã‚­ãƒ£ãƒƒãƒã•ã‚Œã¦ã„ã‚‹ã‹
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯åˆ†ã‹ã‚Šã‚„ã™ã„ã‹

## å‡ºåŠ›å½¢å¼

- **å ´æ‰€**: ãƒ•ã‚¡ã‚¤ãƒ«å:è¡Œç•ªå·
- **å•é¡Œ**: ä½•ãŒå•é¡Œã‹
- **ä¸è¶³ãƒ†ã‚¹ãƒˆ**: è¿½åŠ ã™ã¹ããƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
- **é‡è¦åº¦**: Critical / Warning / Suggestion
EOF

# -----------------------------------------------------------------------------
# .claude/agents/discord-expert.md
# -----------------------------------------------------------------------------
cat > .claude/agents/discord-expert.md << 'EOF'
---
name: discord-expert
description: Discord APIã€Botè¨­è¨ˆã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’åˆ†æžã™ã‚‹å ´åˆã«ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã€‚
tools: Glob, Grep, Read, WebSearch
model: inherit
---

ã‚ãªãŸã¯Discord Boté–‹ç™ºã®å°‚é–€å®¶ã§ã™ã€‚ä»¥ä¸‹ã®è¦³ç‚¹ã§ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚

## åˆ†æžè¦³ç‚¹

### Discord API
- discord.py ã®é©åˆ‡ãªä½¿ç”¨
- Intents ã®é©åˆ‡ãªè¨­å®š
- ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã®å®Ÿè£…

### ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- 50ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ç§’ã®åˆ¶é™ã‚’è€ƒæ…®ã—ã¦ã„ã‚‹ã‹
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚¨ãƒ©ãƒ¼ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### é–‹ç™ºè€…ãƒãƒªã‚·ãƒ¼æº–æ‹ 
- ãƒ‡ãƒ¼ã‚¿ã®AIå­¦ç¿’åˆ©ç”¨ç¦æ­¢ã®éµå®ˆ
- ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ç¦æ­¢ã®éµå®ˆ
- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·

### Workspaceåˆ†é›¢
- ã‚µãƒ¼ãƒãƒ¼ï¼ˆWorkspaceï¼‰é–“ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- æ¨©é™ãƒã‚§ãƒƒã‚¯ã®å®Ÿè£…

## å‡ºåŠ›å½¢å¼

- **å ´æ‰€**: ãƒ•ã‚¡ã‚¤ãƒ«å:è¡Œç•ªå·
- **å•é¡Œ**: ä½•ãŒå•é¡Œã‹
- **Discordå›ºæœ‰ã®è€ƒæ…®äº‹é …**: APIã‚„ãƒãƒªã‚·ãƒ¼ã¨ã®é–¢é€£
- **ææ¡ˆ**: ã©ã†æ”¹å–„ã™ã¹ãã‹
- **é‡è¦åº¦**: Critical / Warning / Suggestion
EOF

echo "âœ… .claude/agents/ ã‚’ä½œæˆã—ã¾ã—ãŸ"

# -----------------------------------------------------------------------------
# src/__init__.py ç­‰
# -----------------------------------------------------------------------------
mkdir -p src/bot
mkdir -p src/db
mkdir -p src/ai/providers
mkdir -p src/storage
mkdir -p tests
mkdir -p .github/workflows

touch src/__init__.py
touch src/bot/__init__.py
touch src/db/__init__.py
touch src/ai/__init__.py
touch src/ai/providers/__init__.py
touch src/storage/__init__.py
touch tests/__init__.py

# -----------------------------------------------------------------------------
# tests/conftest.py
# -----------------------------------------------------------------------------
cat > tests/conftest.py << 'EOF'
"""Pytest configuration and fixtures."""

import pytest
from unittest.mock import AsyncMock


@pytest.fixture
def mock_ai_provider():
    """AIãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒ¢ãƒƒã‚¯"""
    provider = AsyncMock()
    provider.generate.return_value = "ã“ã‚Œã¯ãƒ¢ãƒƒã‚¯ã®å¿œç­”ã§ã™"
    provider.embed.return_value = [0.1] * 1536
    return provider


@pytest.fixture
def mock_ai_router(mock_ai_provider):
    """AIãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒ¢ãƒƒã‚¯"""
    router = AsyncMock()
    router.get_provider.return_value = mock_ai_provider
    return router
EOF

# -----------------------------------------------------------------------------
# .github/workflows/test.yml
# -----------------------------------------------------------------------------
cat > .github/workflows/test.yml << 'EOF'
name: Test

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest, windows-latest]
        python-version: ['3.11']

    steps:
      - uses: actions/checkout@v4

      - name: Install uv
        uses: astral-sh/setup-uv@v4

      - name: Set up Python
        run: uv python install ${{ matrix.python-version }}

      - name: Install dependencies
        run: uv sync --all-extras

      - name: Run ruff
        run: uv run ruff check src/

      - name: Run tests
        run: uv run pytest tests/ -v --cov=src --cov-report=xml

      - name: Upload coverage
        uses: codecov/codecov-action@v4
        if: matrix.os == 'ubuntu-latest'
EOF

echo "âœ… CIè¨­å®šã‚’ä½œæˆã—ã¾ã—ãŸ"

# -----------------------------------------------------------------------------
# å®Œäº†å‡¦ç†
# -----------------------------------------------------------------------------
echo ""
echo "=========================================="
echo "ðŸŽ‰ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸï¼"
echo "=========================================="
echo ""
echo "æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:"
echo "1. uv sync          # ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
echo "2. cp .env.example .env  # ç’°å¢ƒå¤‰æ•°è¨­å®š"
echo "3. uv run pre-commit install  # pre-commitè¨­å®š"
echo ""
echo "ç¢ºèªã‚³ãƒžãƒ³ãƒ‰:"
echo "  uv run ruff check src/   # ãƒªãƒ³ãƒˆãƒã‚§ãƒƒã‚¯"
echo "  uv run pytest tests/ -v  # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ"
echo ""
