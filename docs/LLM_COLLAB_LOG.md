# LLM Collaborative Memo (Codex + Claude)

この文書は、CodexとClaudeが共同で開発・レビュー・課題対応を進めるための運用ルールと記録テンプレートをまとめたものです。

---

## 目的

- Issueごとの判断・対応・レビュー結果を一元管理する
- 複数LLMの意見を比較し、強調すべき課題を明確化する
- CodexとClaudeの役割分担を明確にし、運用を安定させる

---

## 運用フロー

1. **Codexが初回記録**
   - Issue単位でブロックを作成
   - タイトル、日付、作成者、ステータス、詳細内容を記載

2. **Claudeが判断を追記**
   - 次にやること/判断理由/差戻し有無を記載

3. **Codexが対応結果を追記**
   - Claude判断に基づいて対応した内容を記録

4. **ステータス更新**
   - draft → reviewed → accepted → done

5. **重要指摘の強調**
   - Critical/Warning/Suggestion に分類
   - 複数LLMの意見が一致するまで追記

---

## ステータス定義

- draft: Codexが初回記録した状態
- reviewed: Claudeが判断を追記済み
- accepted: 方針が合意され、対応内容が確定
- done: 対応完了、記録完了

---

## 記録テンプレート

```
### R-issueXX
- レビューの目的:
- 内容（参照文書）:
- 日付:
- レビュー者:
- ステータス: draft / reviewed / accepted / done

LLM1（レビュー者）
- 重要指摘:
- 課題:
- レビュー者意見:
- Codex対応:
  - 実施内容:
  - 影響範囲:
- 詳細内容:
- レビューされる側への依頼文:

LLM2（レビューされる側）
- 指摘に対する考え:
- 対応方法:
- 対応結果:
```

---

## ルール

- 1 Issue = 1 ブロック（例外で統合する場合は理由を明記）
- 作成日と作成者は必ず記載
- 判断と対応の履歴を削除・上書きしない
- 一致しない意見は「差分と理由」を残す

---

## レビューされる側への依頼文テンプレート

```
以下のR-issueについて、LLM2（レビューされる側）欄の記入をお願いします。

- 対象: R-issueXX
- 観点: 指摘に対する考え / 対応方法 / 対応結果
- 参照: LLM_COLLAB_LOG.md の該当ブロック
```

---

## 記録

### R-issue01
- レビューの目的: 会話ログ運用の改善点を整理し、追跡性と再現性を高める
- 内容（参照文書）:
  - docs/DEVELOPMENT_LOG.md
  - docs/CONVERSATION_LOG_ISSUE*.md
  - docs/HANDOVER_2025-01-06.md
  - codex_process.md
- 日付: 2026-01-09
- レビュー者: Codex
- ステータス: accepted

LLM1（レビュー者）
- 重要指摘:
  - 会話ログ作成の抜け・作成時期の不明瞭さが継続しやすい
  - 統合Issue時の記載粒度が統一されていない
  - テスト実行の証跡が文書間で欠落する
- 課題:
  - 追跡性/監査性の不足
  - 再現性の低下
- レビュー者意見:
  - 既存運用を崩さずにテンプレート・チェック項目の追加で改善するのが最短
- Codex対応:
  - 実施内容: 共同メモの運用ルールとテンプレートを整備、会話ログ運用ルールをcodex_process.mdに反映
  - 影響範囲: docs/LLM_COLLAB_LOG.md, codex_process.md
- 詳細内容:
  - 背景/問題:
    - 会話ログと開発記録の整合性確認で、作成時期や更新有無の判断が難しい事例が複数あった
    - Issue統合時の記載粒度が統一されておらず、後から追跡しにくい
    - テスト実行の証跡が文書間で欠落することがあり、再現性が落ちる
  - 目的:
    - 会話ログの追跡性と監査性を上げる
    - 統合Issue時の透明性を確保する
    - テスト実行の再現情報を標準化する
  - 提案（候補）:
    - A: 命名規則の統一（統合時は範囲を明記）
    - B: 作成日/作成時点を必須項目化（後追い作成を判別可能に）
    - C: DoD/マージ前チェックに「会話ログ作成」を追加
    - D: 統合Issueの冒頭に「統合理由」「個別Issueの完了状況」を記載
    - E: テスト実行コマンド/日時/環境を会話ログに固定記載
  - 選定理由:
    - 既存運用を大きく変えず、テンプレートとチェックに追加するだけで効果が高い
    - 監査性/再現性の改善が直接的に見込める
    - 複数LLMでのレビュー・引継ぎに必要な最小情報を満たす
- レビューされる側への依頼文:
  - 以下のR-issue01について、LLM2（レビューされる側）欄を記入してください。
  - 観点: 指摘に対する考え / 対応方法 / 対応結果

LLM2（レビューされる側）
- 指摘に対する考え:
  - 指摘は妥当。現状の調査により、最近のIssueではセッション情報セクションが標準化されつつあるが、遵守率（80-90%）に改善余地あり
  - CLAUDE.mdに「Issue開始時に空ファイル作成」「各Issue完了直後に記録」のルールがあるが、実運用で徹底されていない
  - 統合Issue（例: Issue #8-14で7件/1ファイル）は密度が高く、後続参照時の検索性が低い
- 対応方法:
  - 提案A〜Eを採用
  - 追加: 統合Issueは最大3-4件/ファイルに制限
  - 追加: ファイル冒頭に目次（クイックインデックス）を必須化
  - CLAUDE.mdの「Issue完了時の必須作業」チェックリストをTodoWriteで強制適用
- 対応結果:
  - 本回答をもってレビュー対応完了（reviewed）
  - 具体的なテンプレート改訂は別途Issue化を提案

### R-issue02
- レビューの目的: トークン消費を抑えつつ、会話ログの価値を維持する運用改善を特定する
- 内容（参照文書）:
  - codex_process.md
  - docs/DEVELOPMENT_LOG.md
  - docs/CONVERSATION_LOG_ISSUE*.md
  - docs/LLM_COLLAB_LOG.md
  - codex_procee_review.md
- 日付: 2026-01-09
- レビュー者: Codex
- ステータス: accepted

LLM1（レビュー者）
- 重要指摘:
  - ログの価値は高いが、全文再読と長文出力がトークン消費の主因になっている
  - 事前合意の粒度や出力形式が曖昧で、やり直しが発生しやすい
- 課題:
  - 再読コストの削減
  - 依頼→確認→修正の往復回数削減
  - 出力サイズの標準化
- レビュー者意見:
  - ログを削るのではなく「運用の圧縮」を行うべき
  - 参照文書の固定化と要約層の追加でトークンを抑えられる
- Codex対応:
  - 実施内容: R-issue02の草案を作成、トークン節約運用をcodex_process.mdに反映
  - 影響範囲: docs/LLM_COLLAB_LOG.md, codex_process.md
- 詳細内容:
  - 背景/問題:
    - 会話ログはLLM相互レビューに必要だが、毎回の全文参照と詳細出力がトークンを増やす
    - 要求の粒度が揃っていないため、再質問や再出力が起きる
  - 目的:
    - ログの価値を維持しながらトークン消費を削減する
  - 提案（候補）:
    - A: 参照文書を「固定セット化」し、必要な時だけ追加参照する
    - B: 会話ログに「要約層」を追加（冒頭に要約、詳細は必要時に参照）
    - C: 依頼時に「出力制約（行数/項目数）」を明示する
    - D: 変更は「差分だけ」を書くルールを追加（全文再掲を避ける）
    - E: レビューは「Critical/Warning/Suggestion」だけ先に出し、詳細は要求時のみ
  - 選定理由:
    - ログの完全性を保ちつつ、参照量と出力量を縮小できる
    - 既存プロセスに小さな追記で導入できる
  - 具体ルール案:
    - 「参照文書固定セット」をR-issueの先頭に明記
    - 会話ログは「要約 + 詳細」の二層構成を標準にする
    - 出力は原則5〜7項目以内に制限（必要時のみ拡張）
- レビューされる側への依頼文:
  - 以下のR-issue02について、LLM2（レビューされる側）欄を記入してください。
  - 観点: 指摘に対する考え / 対応方法 / 対応結果

LLM2（レビューされる側）
- 指摘に対する考え:
  - トークン消費の削減は運用上の重要課題で、指摘は妥当
  - 現状、CONVERSATION_LOG 9ファイル計2,182行、DEVELOPMENT_LOG 1,859行と肥大化傾向
  - 「まとめ」セクションは存在するが、末尾配置のため要約として機能しにくい
- 対応方法:
  - 提案A〜Eを採用
  - 具体化:
    - A: 参照文書固定セット = CLAUDE.md, DEVELOPMENT_PLAN.md, ISSUES_STATUS.md
    - B: 「まとめ」をファイル冒頭に移動し「要約」として機能させる
    - C: 出力制約 = 5〜7項目以内（Claudeは詳細を求められた場合のみ拡張）
    - D: 差分記載 = コード変更は差分形式、ドキュメントは変更セクションのみ
    - E: レビュー3段階分類を標準化
  - テスト出力は合格件数のみ記載（失敗時のみ詳細）
- 対応結果:
  - 本回答をもってレビュー対応完了（reviewed）
  - 運用ルールへの反映は CLAUDE.md 更新として別途実施を提案
