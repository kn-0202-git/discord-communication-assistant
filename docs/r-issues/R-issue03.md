# R-issue03

- レビューの目的: Issue途中でも混乱なく引き継げる運用の可否を評価し、必要な最小対策を決める
- 内容（参照文書）:
  - docs/reference/LLM_COLLAB_LOG.md
  - docs/handover/HANDOVER_2026-01-11.md
  - docs/logs/DEVELOPMENT_LOG.md
  - docs/planning/DEVELOPMENT_PLAN.md
- 日付: 2026-01-11
- レビュー者: Codex
- ステータス: accepted

LLM1（レビュー者）
- 重要指摘:
  - Claudeがリミットに達した時点で開発が停止する
  - Claude→Codexの引き継ぎ手順が曖昧で、再開に時間がかかる
  - 更新漏れで最新状態が不明になるリスクが高い
  - 差分だけの記録だと意思決定理由が欠落する
  - テスト実行の有無が不明になりやすい
  - 機密情報混入のリスクがある
  - 参照範囲が広がりトークン消費が増える
- 課題:
  - 引き継ぎ可能性の担保
  - Claude停止時でもCodexが即時復帰できる状態の維持
  - 最小コストでの記録品質確保
  - セキュリティ/再現性/可観測性の最低限の確保
- レビュー者意見:
  - 追加対策は必要だが軽量で足りる
  - 必須項目テンプレと更新タイミングの固定が最も効果的
- Codex対応:
  - 実施内容: 必須項目テンプレ案と更新タイミングのルール化を提案
- 影響範囲: docs/reference/LLM_COLLAB_LOG.md, docs/handover/HANDOVER_*.md
- 詳細内容:
  - 背景/問題:
    - LLMセッションが制限で切れた場合、途中の判断と次アクションが失われる
    - 会話ログが肥大化すると再読コストが増え、引き継ぎが遅くなる
  - 専門家別リスクアセス:
    - プロジェクト管理:
      - リスク: 更新漏れで最新状態が不明、計画と実態が乖離
      - 影響: 中〜高 / 起こりやすさ: 中 / 対策要否: 必要
      - 対策: 開始/中間/終了の3点更新をDoDに組み込み、未更新なら次作業へ進まない
    - ソフトウェアエンジニア:
      - リスク: 差分記録のみで設計意図が消え、復帰時に再判断が必要
      - 影響: 中 / 起こりやすさ: 中 / 対策要否: 必要
      - 対策: 差分 + 意思決定1行（理由）を必須化
    - QA:
      - リスク: テスト実行有無が不明で品質状態が曖昧
      - 影響: 高 / 起こりやすさ: 中 / 対策要否: 必要
      - 対策: テスト実行有無と合格件数を必須、失敗時のみ詳細
    - セキュリティ:
      - リスク: APIキー等の機密情報がログに混入
      - 影響: 高 / 起こりやすさ: 低〜中 / 対策要否: 必要
      - 対策: 機密情報の記載禁止を明文化し、簡易チェック項目を追加
    - 運用/可観測性:
      - リスク: 誰がいつ更新したか曖昧で責任境界が不明
      - 影響: 中 / 起こりやすさ: 中 / 対策要否: 必要
      - 対策: 日付・記入者・ステータスの必須化
    - 情報設計:
      - リスク: 文書が増え、どれが一次情報か分からない
      - 影響: 中 / 起こりやすさ: 中 / 対策要否: 必要
      - 対策: 固定参照セットと「一次情報は引き継ぎカプセル」を明記
    - LLM運用:
      - リスク: 参照範囲拡大でトークン消費が増え、復帰コストが上がる
      - 影響: 中 / 起こりやすさ: 高 / 対策要否: 必要
      - 対策: 固定参照セット + 要約必須化、詳細はオンデマンド
  - リスク評価（要点）:
    - Claude停止で開発が中断 → 影響: 高 / 起こりやすさ: 中
    - Claude→Codex引き継ぎが曖昧 → 影響: 中〜高 / 起こりやすさ: 中
    - 更新漏れ → 影響: 中〜高 / 起こりやすさ: 中
    - 理由欠落 → 影響: 中 / 起こりやすさ: 中
    - テスト不明 → 影響: 高 / 起こりやすさ: 中
    - 機密混入 → 影響: 高 / 起こりやすさ: 低〜中
    - 参照過多 → 影響: 中 / 起こりやすさ: 高
  - 対策（要否: 必要）:
    - Claudeが止まってもCodexが再開できる「引き継ぎカプセル」を必須化
    - 引き継ぎカプセルの更新タイミングを開始/中間/終了に固定
    - 開始/中間判断/終了の3点更新を必須化
    - 差分 + 意思決定1行を必須化
    - テスト実行有無と合格件数を必須化（失敗時のみ詳細）
    - 機密情報の記載禁止を明文化
    - 固定参照セットを明記し追加参照は必要時のみ
  - Codex復帰を想定した運用:
    - 引き継ぎカプセルに「Claude最終状態」を1行で記載
    - Codex側で最初に確認する文書セットを固定化
  - 必須項目テンプレ（最小セット）:
    - Issue番号 / 目的 / 進捗
    - Claude最終状態（どこまでやったか・止まった理由）
    - 決定事項（1行）
    - 次にやること（最大3つ）
    - 変更ファイル（差分）
    - テスト結果（実行有無 + 合格件数）
    - ブロッカー / 依存関係
- レビューされる側への依頼文:
  - 以下のR-issue03について、LLM2（レビューされる側）欄を記入してください。
  - 観点: 指摘に対する考え / 対応方法 / 対応結果

LLM2（レビューされる側）
- 指摘に対する考え:
  - 全ての指摘は妥当であり、対応が必要と考える
  - 特に重要な課題:
    1. Claude停止時の継続性担保 → 引き継ぎカプセルの必須化で対応可能
    2. テスト結果の可視化 → 既にHANDOVERテンプレートで実践中
    3. トークン消費の抑制 → 固定参照セットで対応可能
  - docs/handover/HANDOVER_2026-01-11.md は既に提案テンプレートに近い形式で運用中
  - CLAUDE.md「Issue完了時の必須作業」にもルール化済み
- 対応方法:
  1. 引き継ぎカプセルの必須項目を明文化（CLAUDE.mdに追記）
  2. 更新タイミング（開始/中間/終了）をDoDに組み込み
  3. 固定参照セットを定義（CLAUDE.md, DEVELOPMENT_PLAN.md, ISSUES_STATUS.md, 最新HANDOVER_*.md）
  4. 機密情報チェック項目を追加
- 対応結果:
  - docs/handover/HANDOVER_2026-01-11.md で以下を実践済み:
    - Issue番号/目的/進捗 ✅
    - テスト結果（件数） ✅
    - 次にやること ✅
    - 変更ファイル ✅
    - ブランチ状況 ✅
  - 追加対応（今後の課題）:
    - 「Claude最終状態」セクションを明示的に追加
    - 「決定事項（1行）」を必須化
    - 「ブロッカー/依存関係」セクションを追加
- 対応日: 2026-01-12
- 対応者: Claude (claude-opus-4-5-20251101)

専門家レビュー（合意事項）
- プロジェクト管理: 開始/中間/終了の3点更新で再開性を担保
- ソフトウェア: 差分 + 意思決定1行で判断理由を保持
- QA: テスト実行有無と合格件数を必須化（失敗時のみ詳細）
- セキュリティ: 機密情報の記載禁止と最終確認チェックを追加
- LLM運用: 固定参照セット + 要約必須でトークン消費を抑制

Codex対応（実施）
- 実施内容:
  - 引き継ぎカプセル運用（更新タイミング/必須項目）をCLAUDE.mdに追記
  - セッション終了前チェックに「引き継ぎカプセル/機密情報確認」を追加
  - 固定参照セットに最新HANDOVERを追加
- 影響範囲: CLAUDE.md
- 対応日: 2026-01-12
